<html>

<head>
<title>Устойчивый таймер TCP</title>

<meta http-equiv="Content-type" content="text/html; charset=koi8-r">
<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>




<p><a NAME="t220000"></a>Глава 22 Устойчивый таймер TCP</p>
<u>

<p><b><a NAME="t221000"></a>Введение</p>
</b></u>

<p><small>Мы видели, что TCP получатель осуществляет
управление потоком данных, указывая количество
данных, которые он хочет получить от отправителя:
размер окна. Что происходит, когда размер окна
становится равным 0? Обычно это останавливает
отправителя, который прекращает передавать
данные до тех пор, пока размер окна станет
ненулевым. </small></p>

<p><small>Именно так разворачивались события на <a HREF="tcp20.html#t202001">рисунке 20.3</a>. Когда отправитель
получает сегмент 9, открывающий окно, которое
было закрыто сегментом 8, он немедленно начинает
посылать данные. TCP должен предпринять какие-либо
действия в том случае, если подтверждение,
открывающее окно (сегмент 9) было потеряно.
Подтверждения передаются ненадежно - другими
словами, TCP не подтверждает сами подтверждения,
он подтверждает только сегменты, содержащие
данные. </small></p>

<p><small>Если подтверждение потеряно, на каждом
конце соединения будут ждать действий от
удаленного конца: получатель ожидает получить
данные (так как он отправил отправителю
ненулевое окно), а отправитель надеется получить
обновление окна, которое позволит ему продолжить
передачу. Чтобы выйти из подобного тупика,
отправитель использует <a NAME="t221001"></a>устойчивый
(persist) таймер, в соответствии с которым
осуществляется периодический опрос получателя
на предмет, не был ли увеличен размер окна.
Сегменты, которые при этом посылает отправитель,
называются <a NAME="t221002"></a>пробами окна (window probes) . В
этой главе мы рассмотрим пробы окна и устойчивый
таймер. Также мы рассмотрим синдром &quot;глупого
окна&quot;, который непосредственно связан с
устойчивым таймером.</small></p>
<u><b>

<p><a NAME="t222000"></a>Пример</p>
</b></u>

<p><small>Чтобы посмотреть, как работает устойчивый
таймер, мы запустим принимающий процесс, который
ожидает прихода запроса на соединение от
клиента, принимает запрос на соединение, а затем
на долго засыпает перед тем, как начать чтение из
сети. </small></p>

<p><small>Программа <a NAME="t222002"></a>sock позволяет
установить паузу с помощью опции <a NAME="t222003"></a>-P,
при этом пауза вставляется между моментом, когда
сервер принимает запрос на соединение, и
моментом, когда будет осуществлено первое
чтение. Мы запустим сервер следующим образом:</small></p>

<p>&nbsp;</p>


<p>svr4 % <b>sock -i -s -P100000 5555</p>
</b>

<p>&nbsp;</p>

<p><small>После запуска этой команды сервер будет
&quot;спать&quot; 100000 секунд (27,8 часов) перед тем, как
начать читать из сети. Клиент запущен на хосте bsdi
и осуществляет записи по 1024 байта на порт сервера
5555. На рисунке 22.1 показан вывод команды tcpdump. (Мы
удалили все имеющее отношение к установлению
соединения.)<a NAME="t222001"></a></small></p>

<p>&nbsp;</p>


<p><br>
1&nbsp;&nbsp;&nbsp; 0.0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bsdi.1027
&gt; svr4.5555: P 1:1025(1024) ack 1 win 4096<br>
2&nbsp;&nbsp;&nbsp; 0.191961 ( 0.1920) svr4.5555 &gt; bsdi.1027: . ack 1025 win 4096<br>
3&nbsp;&nbsp;&nbsp; 0.196950 ( 0.0050) bsdi.1027 &gt; svr4.5555: . 1025:2049(1024) ack 1
win 4096<br>
4&nbsp;&nbsp;&nbsp; 0.200340 ( 0.0034) bsdi.1027 &gt; svr4.5555: . 2049:3073(1024) ack 1
win 4096<br>
5&nbsp;&nbsp;&nbsp; 0.207506 ( 0.0072) svr4.5555 &gt; bsdi.1027: . ack 3073 win 4096<br>
6&nbsp;&nbsp;&nbsp; 0.212676 ( 0.0052) bsdi.1027 &gt; svr4.5555: . 3073:4097(1024) ack 1
win 4096<br>
7&nbsp;&nbsp;&nbsp; 0.216113 ( 0.0034) bsdi.1027 &gt; svr4.5555: P 4097:5121(1024) ack 1
win 4096<br>
8&nbsp;&nbsp;&nbsp; 0.219997 ( 0.0039) bsdi.1027 &gt; svr4.5555: P 5121:6145(1024) ack 1
win 4096<br>
9&nbsp;&nbsp;&nbsp; 0.227882 ( 0.0079) svr4.5555 &gt; bsdi.1027: . ack 5121 win 4096<br>
10&nbsp;&nbsp;&nbsp; 0.233012 ( 0.0051) bsdi.1027 &gt; svr4.5555: P 6145:7169(1024) ack 1
win 4096<br>
11&nbsp;&nbsp;&nbsp; 0.237014 ( 0.0040) bsdi.1027 &gt; svr4.5555: P 7169:8193(1024) ack 1
win 4096<br>
12&nbsp;&nbsp;&nbsp; 0.240961 ( 0.0039) bsdi.1027 &gt; svr4.5555: P 8193:9217(1024) ack 1
win 4096<br>
13&nbsp;&nbsp;&nbsp; 0.402143 ( 0.1612) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
14&nbsp;&nbsp;&nbsp; 5.351561 ( 4.9494) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win
4096<br>
15&nbsp;&nbsp;&nbsp; 5.355571 ( 0.0040) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
16&nbsp;&nbsp; 10.351714 ( 4.9961) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win 4096<br>
17&nbsp;&nbsp; 10.355670 ( 0.0040) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
18&nbsp;&nbsp; 16.351881 ( 5.9962) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win 4096<br>
19&nbsp;&nbsp; 16.355849 ( 0.0040) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
20&nbsp;&nbsp; 28.352213 (11.9964) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win 4096<br>
21&nbsp;&nbsp; 28.356178 ( 0.0040) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
22&nbsp;&nbsp; 52.352874 (23.9967) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win 4096<br>
23&nbsp;&nbsp; 52.356839 ( 0.0040) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
24&nbsp; 100.354224 (47.9974) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win 4096<br>
25&nbsp; 100.358207 ( 0.0040) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
26&nbsp; 160.355914 (59.9977) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win 4096<br>
27&nbsp; 160.359835 ( 0.0039) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
28&nbsp; 220.357575 (59.9977) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win 4096<br>
29&nbsp; 220.361668 ( 0.0041) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
<br>
30&nbsp; 280.359254 (59.9976) bsdi.1027 &gt; svr4.5555: . 9217:9218(1) ack 1 win 4096<br>
31&nbsp; 280.363315 ( 0.0041) svr4.5555 &gt; bsdi.1027: . ack 9217 win 0<br>
</p>


<p>&nbsp;</p>

<p><small>Рисунок 22.1 Пример устойчивого таймера при
пробах окна нулевого размера.&nbsp;</small></p>

<p>&nbsp;</p>

<p><small>В сегментах 1-13 осуществляется обычная
передача данных от клиента к серверу, при этом
заполняется окно размером 9216 байт. Сервер
объявил окно равное 4096 и имеет размер буфера
сокета по умолчанию равный 4096, однако в
действительности принимает 9216 байт. Это является
формой взаимодействия между кодами TCP/IP и
потоковой подсистемой в <a NAME="t222004"></a>SVR4. </small></p>

<p><small>В сегменте 13 сервер подтверждает
предыдущие четыре сегмента данных, однако
объявляет окно равное 0, приостанавливая тем
самым передачу данных от клиента. Клиент
вынужден установить свой устойчивый таймер. Если
клиент не получил обновление окна до истечения
таймера, он осуществляет пробу пустого окно,
чтобы проверить не было ли потеряно обновление
окна. Так как процесс сервера спит, 9216 байт данных
буферизированы TCP и ожидают, что будут переданы
приложению. </small></p>

<p><small>Обратите внимание на промежутки времени
между пробами окна, которые осуществляет клиент.
Первая (сегмент 14) происходит через 4,949 секунды
после получения окна нулевого размера. Следующая
(сегмент 16) - через 4,996 секунды. Затем промежутки
между пробами становятся приблизительно равными
6, 12, 24, 48 и 60 секунд после предыдущей пробы. </small></p>

<p><small>Почему промежутки всегда на какую-то долю
секунды меньше чем 5, 6, 12, 24, 48 и 60? Пробы
осуществляются в соответствии с
500-миллисекундным таймером TCP. Когда таймер
истекает, отправляется проба окна, а отклик
принимается примерно через 4 миллисекунды.
Получение отклика, вновь устанавливает таймер,
однако время до следующего тика часов составляет
примерно 500 минус 4 миллисекунды. </small></p>

<p><small>При расчете устойчивого таймера
используется обычное <a NAME="t222005"></a>экспотенциальное
наращивание TCP. Первый тайм-аут рассчитывается
как 1,5 секунды для стандартного соединения по
локальной сети. Затем это значение умножается на
2 для второго тайм-аута (значение равное 3
секундам). Множитель равный 4-м дает следующее
значение равное 6, множитель равный 8-ми дает
значение 12, и так далее. Однако, устойчивый таймер
всегда находится в диапазоне между 5 и 60
секундами, и именно эти значения мы видим на
рисунке 22.1. </small></p>

<p><small>Проба окна содержит 1 байт данных (номер
последовательности 9217). TCP всегда позволяет
послать 1 байт данных, после того как окно было
закрыто. Однако подтверждения, возвращающиеся с
номером окна равным 0, не подтверждают этот байт.
(Эти ACK получены для всех байтов с номером меньше
чем 9216, и на байт с номером 9216.) Поэтому, этот байт
будет передан повторно. </small></p>

<p><small>Характеристика устойчивого состояния
отличается от тайм-аутов при повторной передаче,
описанных в <a HREF="tcp21.html">главе 21</a>, тем, что TCP
никогда не прекращает отправку проб окна. Эти
пробы окна отправляются с 60-секундными
интервалами до тех пор, пока окно не будет
открыто, или приложение решит, что соединение
должно быть разорвано.</small></p>
<u><b>

<p><a NAME="t223000"></a>Синдром &quot;глупого&quot; окна</p>
</b></u>

<p><small>При использовании окон в схемах управления
потоком данных (таких как используется в TCP) могут
возникнуть условия известные как <a NAME="t223001"></a>синдром
&quot;глупого&quot; окна (SWS - silly window syndrome). В этом
случае, по соединению, осуществляется обмен
небольшим количеством данных вместо обмена
сегментами полного размера [<a NAME="t223002"></a>Clark 1982]. </small></p>

<p><small>Причиной этого может стать любой участник
обмена: получатель может объявить маленькие окна
(вместо того чтобы дождаться возможности
объявить большее окно), а отправитель может
передавать маленькое количество данных (вместо
того чтобы дождаться дополнительных данных и
послать больший сегмент). Корректно избежать
синдрома глупого окна можно на обоих концах
соединения.</small></p>

<p><small>&nbsp;</small> 

<ol>
  <li><small>Получатель не должен объявлять маленькие
    окна. Стандартный алгоритм определяет, что
    получатель не должен объявлять окно больше, чем
    объявлено в настоящий момент (которое может быть
    равным 0), до тех пор, пока окно не будет увеличено
    хотя бы на один сегмент полного размера (принятый
    <a NAME="t223003"></a>MSS) или на половину размера буфера
    получателя, в зависимости от того, какое значение
    меньше.</small></li>
  <li><small>Отправитель может избежать синдрома
    глупого окна, приостанавливая передачу, если
    одно из следующих условий неверно: (a) может быть
    отправлен сегмент полного размера, (b) можно
    отправить по меньшей мере половину от
    максимального размера окна, объявленного
    удаленным концом, или (c) можно послать все что у
    нас есть, а также мы не ожидаем подтверждения (нет
    неподтвержденных данных), или для этого
    соединения выключен алгоритм Нагла (глава 19,
    раздел <a HREF="tcp19.html#t194000">&quot;Алгоритм Нагла&quot;</a>).</small><p><small>Условие
    (b) имеет отношение к хостам, которые всегда
    объявляют очень маленькие окна, возможно даже
    меньше чем размер сегмента. Условие (c) позволяет
    избежать отправки маленьких сегментов, когда у
    нас есть неподтвержденные данные, которые
    ожидают того, чтобы быть подтвержденными, и
    включен алгоритм Нагла. Если приложение
    осуществляет маленькие записи (меньше чем размер
    сегмента), условие (c) позволяет избежать синдрома
    глупого окна.</small></p>
    <p><small>Эти условия также позволяют ответить на
    вопрос: спасает ли алгоритм Нагла от отправки
    маленьких сегментов, пока существуют
    неподтвержденные данные и что означает слово
    &quot;маленький&quot;? Из условия (a) мы видим, что
    &quot;маленький&quot; означает - количество байтов
    меньше чем размер сегмента. Условие (b) имеет
    отношение только к старым, примитивным хостам.</small></p>
  </li>
</ol>

<p>&nbsp;</p>

<p><small>Условие (b) в шаге 2 требует, чтобы
отправитель отслеживал максимальный размер
окна, объявленный удаленным концом. Здесь
отправителем делается попытка догадаться о
размере буфера получателя на удаленном конце.
Несмотря на то, что размер буфера получателя
может уменьшаться в процессе установления
соединения, на практике это происходит редко. </small></p>
<i><b>

<p>Пример</p>
</b></i>

<p><small>Сейчас мы подробно рассмотрим, как можно
избежать синдрома глупого окна и как работает
устойчивый таймер. Мы воспользуемся программой <a NAME="t223004"></a>sock с отправляющего хоста, sun, который
сделает в сеть шесть записей размером 1024 байта:</small></p>

<p>&nbsp;</p>


<p>sun % <b>sock -i -n6 bsdi 7777</p>
</b>

<p>&nbsp;</p>

<p><small>Принимающий процесс на хосте bsdi сделает
несколько пауз, а именно, перед осуществлением
первого считывания пауза продлиться 4 секунды, а
между каждым следующим считыванием пауза
составит 2 секунды. Получатель считывает данные
по 256 байт:</small></p>

<p>&nbsp;</p>


<p>bsdi % <b>sock -i -s -P4 -p2 -r256 7777</p>
</b>

<p>&nbsp;</p>

<p><small>Первая пауза позволяет заполнить <a NAME="t223005"></a>буфер
приемника, что заставляет его остановить
передатчик. Так как получатель затем
осуществляет маленькие считывания из сети, мы
ожидаем, что получатель применит процедуру
предотвращения синдрома глупого окна. </small></p>

<p><small>На рисунке 22.2 показана временная диаграмма
для передачи 6144 байт данных. (Мы удалили все
связанное с установлением соединения.) </small></p>

<p><small>Нам необходимо отследить следующее: что
происходит с приложением, которое считывает
данные в каждый момент времени, количество байт,
находящихся в настоящий момент в приемном
буфере, и размер свободного пространства в
приемном буфере (в байтах). На рисунке 22.3
приведены эти данные.<a NAME="t223006"></a></small></p>


<p ALIGN="CENTER"><small><img SRC="t22_2000.jpg" WIDTH="506" HEIGHT="755"></small></p>


<p ALIGN="CENTER"><small>Рисунок 22.2 Временная диаграмма,
показывающая, как получатель предотвращает
появление синдрома глупого окна.</small></p>

<p>&nbsp;</p>


<table BORDER="1" CELLSPACING="1" BORDERCOLOR="#000000" CELLPADDING="5" WIDTH="838">
  <tr>
    <td WIDTH="10%" VALIGN="TOP" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>Время</small></td>
    <td WIDTH="12%" VALIGN="TOP" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>Номер
    сегмента</small></td>
    <td WIDTH="55%" VALIGN="TOP" COLSPAN="3" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>Действие</small></td>
    <td WIDTH="23%" VALIGN="TOP" COLSPAN="2" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>Буфер приемника</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP" BGCOLOR="#ffffff">&nbsp;</td>
    <td WIDTH="12%" VALIGN="TOP" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>(рисунок
    22.2)</small></td>
    <td WIDTH="20%" VALIGN="TOP" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>Отправляющий
    TCP</small></td>
    <td WIDTH="20%" VALIGN="TOP" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>Принимающий
    TCP</small></td>
    <td WIDTH="15%" VALIGN="TOP" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>Приложение</small></td>
    <td WIDTH="10%" VALIGN="TOP" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>данные</small></td>
    <td WIDTH="13%" VALIGN="TOP" BGCOLOR="#ffffff"><p ALIGN="CENTER"><small>свободно</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>0,000</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>1</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>1:1025(1024)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>1024</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>3072</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>0,002</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>2</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>1025:2049(1024)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2048</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>2048</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>0,003</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>3</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>2049:3073(1024)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3072</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1024</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>0,005</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>4</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>3073:4097(1024)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>4096</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>0</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>0,170</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>5</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 4097, win 0</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>3,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3840</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>256</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>5,151</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>6</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>4097:4098(1)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3841</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>255</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>5,17</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>7</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 4098, win 0</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>5,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3585</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>511</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>7,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3329</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>767</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>9,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3073</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1023</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>10,151</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>8</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>4098:4099(1)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3074</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1022</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>10,170</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>9</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 4099, win 0</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>11,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2818</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1278</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>13,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2562</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1534</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>15,151</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>10</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>4099:4100(1)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2563</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1533</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>15,170</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>11</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 4100, win
    1533</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>15,172</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>12</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>4100:5124(1024)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3587</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>509</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>15,370</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>13</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 5124, win 509</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>15,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3331</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>765</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>17,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3075</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1021</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>19,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2819</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1277</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>20,151</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>14</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>5124:5633(509)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3328</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>768</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>20,170</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>15</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 5633, win 0</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>21,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3072</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1024</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>23,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2816</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1280</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>25,151</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>16</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>5633:5634(1)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2817</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1279</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>25,170</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>17</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 5634, win
    1279</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>25,171</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>18</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>5634:6145(511)</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3328</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>768</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>25,174</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>19</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 6146, win 767</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>25,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>3072</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1024</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>27,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2816</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1280</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>29,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2560</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1536</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>31,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2304</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>1792</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>33,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>2048</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>2048</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>35,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>1792</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>2304</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>37,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>1536</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>2560</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>39,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>1280</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>2816</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>39,99</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>20</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 6146, win
    2816</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>41,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>1024</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>3072</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>43,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>768</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>3328</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>45,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>512</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>3584</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>47,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>256</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>3840</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>49,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>0</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>4096</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>51,99</small></td>
    <td WIDTH="12%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP"><p ALIGN="CENTER"><small>читает 256
    (EOF)</small></td>
    <td WIDTH="10%" VALIGN="TOP"><p ALIGN="CENTER"><small>0</small></td>
    <td WIDTH="13%" VALIGN="TOP"><p ALIGN="CENTER"><small>4096</small></td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>51,991</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>21</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 6146, win
    4096</small></td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
  <tr>
    <td WIDTH="10%" VALIGN="TOP"><small>51,992</small></td>
    <td WIDTH="12%" VALIGN="TOP"><p ALIGN="CENTER"><small>22</small></td>
    <td WIDTH="20%" VALIGN="TOP"><p ALIGN="CENTER"><small>ACK 2</small></td>
    <td WIDTH="20%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="15%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="10%" VALIGN="TOP">&nbsp;</td>
    <td WIDTH="13%" VALIGN="TOP">&nbsp;</td>
  </tr>
</table>


<p><small>Рисунок 22.3 Как получатель избавляется от
синдрома глупого окна.</small></p>

<p>&nbsp;</p>

<p><small>В первой колонке на рисунке 22.3 приводится
относительный момент времени соответствующий
каждому действию. Величины времени с тремя
цифрами справа от десятичной точки взяты из
вывода команды tcpdump (рисунок 22.2). Величины времени
со значением 99 справа от десятичной точки - это
предполагаемая продолжительность
функционирования принимающего хоста. (Наличие
этих относительных времен на принимающем конце и
содержащих 99 в позиции сотых долей секунд
указывает на их взаимосвязь с сегментами 20 и 22 на
рисунке 22.2, только два события на приемнике,
которые мы видим в выводе команды tcpdump, произошли
на принимающем хосте по тайм-ауту. Все другие
пакеты, отправленные bsdi, отправлены по приему
сегмента от отправителя. Также необходимо
принять во внимание, что это могло бы поместить
исходную 4-секундную паузу непосредственно перед
моментом времени 0, когда отправитель передает
первый сегмент данных. Это примерно тогда, когда
получатель берет управление после приема
подтверждения на свой SYN при установлении
соединения.) </small></p>

<p><small>Размер буфера приемника увеличивается,
когда он получает данные от получателя, и
уменьшается, когда приложение считывает данные
из буфера. Нам необходимо проследить за
объявлениями окна, которые отправляются
получателем отправителю, и за тем, что содержат
эти объявления окна. Таким образом, мы можем
увидеть, как получатель избегает синдрома
глупого окна. </small></p>

<p><small>Первые четыре сегмента данных и
соответствующие ACK (сегменты 1-5) показывают, что
отправитель заполнил буфер приемника. В этой
точке отправитель останавливается, однако у него
все еще остались данные, которые необходимо
отправить. Он устанавливает свой устойчивый
таймер в минимальное значение равное 5 секундам. </small></p>

<p><small>Когда таймер истек, посылается 1 байт данных
(сегмент 6). Принимающее приложение считало 256
байт из <a NAME="t223007"></a>приемного буфера (в момент
времени 3,99), таким образом, байт принимается и
подтверждается (сегмент 7). Однако, объявленное
окно все еще равно 0, так как у приемника нет места
равного одному сегменту полного размера или
половине своего буфера. Именно таким образом,
получатель избегает появления синдрома глупого
окна. </small></p>

<p><small>Устойчивый таймер отправителя
сбрасывается и устанавливается снова через 5
секунд (момент времени 10,151). Снова отправляется и
подтверждается один байт (сегменты 8 и 9). И снова,
размер свободного места в буфере приемника (1022
байта) заставляет его объявить окно равное 0. </small></p>

<p><small>Когда устойчивый таймер отправителя
истекает в следующий раз (в момент времени 15,151),
отправляется и подтверждается еще один байт
(сегменты 10 и 11). В это время получатель имеет в
буфере 1533 байта свободного пространства, поэтому
объявляется окно ненулевого размера.
Отправитель немедленно пользуется этим и
отправляет 1024 байта (сегмент 12). Подтверждение на
эти 1024 байта (сегмент 13) объявляет окно равное 509
байт. Это противоречит тому, что мы видели раньше
с объявлениями маленьких окон. </small></p>

<p><small>Здесь произошло следующее: сегмент 11
объявил окно размером 1533 байта, однако
отправитель отправил только 1024 байта. Если
подтверждение в сегменте&nbsp;13 объявит окно
равное 0, это будет противоречить принципу TCP,
который заключается в том, что окно не может
изменяться путем перемещения его правого края
влево (глава 20, раздел <a HREF="tcp20.html#t203000">&quot;Изменение
размера окна&quot;</a>). Именно поэтому должно быть
объявлено маленькое окно размером в 509 байт. </small></p>

<p><small>Затем необходимо обратить внимание на то,
что отправитель отправляет это маленькое окно не
сразу. Это уже меры, которые принимает
отправитель, чтобы избавиться от синдрома
глупого окна. Отправитель ожидает истечения еще
одного устойчивого таймера (момент времени 20,151) и
только тогда посылает 509 байт. Даже если все равно
отправляется маленький сегмент размером 509 байт
данных, отправитель ожидает 5 секунд, чтобы
посмотреть, не придет ли ACK и не объявит ли
большее окно. После прихода 509 байт данных в
буфере приемника остается всего лишь 768 байт
свободного места, поэтому подтверждение (сегмент
15) объявляет окно равное 0. </small></p>

<p><small>Устойчивый таймер снова включается в
момент времени 25,151, а отправитель передает 1 байт.
В буфере получателя этот момент 1279 байт
свободного пространства, окно такого размера
объявляется в сегменте 17. </small></p>

<p><small>Отправителю необходимо отправить только 511
дополнительных байт, которые он немедленно
отправляет после получения объявления окна
размером 1279 байт (сегмент 18). Этот сегмент также
содержит флаг FIN. Получатель подтверждает данные
и FIN, объявляя окно размером 767. (См. <a HREF="#t224001">упражнение
2</a> в конце главы.)</small></p>

<p><small>Так как отправляющее приложение выдало
сигнал закрытия, после того как сделало шесть
записей размером 1024 байта, соединение со стороны
отправителя переходит из состояния <a NAME="t223008"></a>ESTABLISHED
в состояние <a NAME="t223009"></a>FIN_WAIT_1, затем в состояние <a NAME="t223010"></a>FIN_WAIT_2 (<a HREF="tcp18.html#t186001">рисунок 18.12</a>). </small></p>

<p><small>Оно остается в этом состоянии до получения
FIN с удаленного конца. Для этого состояния не
существует таймера (обратитесь к нашему
обсуждению в конце раздела <a HREF="tcp18.html#t186000">&quot;Диаграмма
состояний передачи TCP&quot;</a> главы 18), поэтому FIN,
который был отправлен в сегменте 18,
подтверждается в сегменте 19. Именно поэтому мы не
видим дальнейшей передачи от отправителя до тех
пор, пока он не получил FIN (сегмент 21). </small></p>

<p><small>Получающее приложение продолжает читать 256
байт данных каждые 2 секунды из приемного буфера.
Почему ACK отправлен в момент времени 39,99
(сегмент&nbsp;20)? Размер свободного места в буфере
получателя увеличился с момента последнего
объявления окна размером 767 (сегмент 19) до 2816,
когда приложение осуществило чтение в момент
времени 39,99. Таким образом, в приемном буфере
появилось 2049 байт свободного пространства.
Обратитесь к первому правилу, с которого мы
начали этот раздел, в соответствии с которым
получатель отправляет обновление окна, потому
что количество свободного места увеличилось на
величину, равную половине размера приемного
буфера. Это означает, что получающий TCP каждый раз
проверяет, нужно ли послать обновления окна,
когда приложение считывает данные из приемного
буфера TCP. </small></p>

<p><small>Последнее чтение, осуществленное
приложением, происходит в момент времени 51,99, и
приложение получает уведомление о конце файла,
так как буфер пуст. Два последних сегмента (21 и 22)
завершают разрыв соединения.</small></p>
<u><b>

<p><a NAME="t224000"></a>Краткие выводы</p>
</b></u>

<p><small>Устойчивый таймер TCP устанавливается одним
концом соединения, когда у него есть данные,
которые необходимо отправить, однако отправка
была остановлена, потому что другой конец
соединения объявил окно нулевого размера.
Отправитель отправляет пробы окна, при этом
интервал повторной передачи рассчитывается так,
как это делалось в <a HREF="tcp21.html">главе 21</a>. Отправка
проб закрытого окна продолжается постоянно. </small></p>

<p><small>С помощью примеров, работы устойчивого
таймера, мы видели, как TCP борется с синдромом
глупого окна. Это необходимо для того, чтобы
предотвратить объявление маленьких окон или
отправку маленьких пакетов. В примерах мы видели,
как происходит предотвращение синдрома глупого
окна на обоих концах, то есть у отправителя и
получателя.</small></p>
<i><b>

<p><a NAME="t224001"></a>Упражнения</b></i> 

<ol>
  <li>На рисунке 22.3 обратите внимание на
    моменты времени соответствующие подтверждениям
    (сегменты 5, 7, 9, 11, 13, 15 и 17): 0,170; 5,170; 10,170; 15,170; 15,370; 20,170
    и 25,170. Также обратите внимание на разницу во
    времени между получением данных и отправкой
    подтверждений: 164,5; 18,5; 18,7; 18,8; 198,3; 18,5 и 19,1
    миллисекунды. Объясните, что бы это могло
    означать.</li>
  <li>На рисунке 22.3 в момент времени 25,174 объявляется
    окно размером 767, однако в приемном буфере есть
    место для 768 байт. Чем объясняется разница в 1
    байт?</li>
</ol>

<hr>

</body>
</html>
